<div class="container" id="horizontal">

  <form role="form" [formGroup]="userForm">

    <div class="form-group row">
      <label class="col-lg-12" for="username">Username</label>
      <div class="col-lg-8">
        <input type="text" class="form-control" style="padding: 1.1em;" formControlName="username" id="username"
          placeholder="Enter Username">
      </div>

      <span *ngIf="!userForm.get('username').valid && userForm.get('username').touched" class="h5">
        <span *ngIf="userForm.get('username').errors['usernameIsTaken']">
          This username is already in use
        </span>

        <span *ngIf="userForm.get('username').errors['required']" class="h5">
          This field is required
        </span>
      </span>

    </div>

    <div class="form-group row">
      <label class="col-lg-12" for="email">Email</label>
      <div class="col-lg-8">
        <input type="email" class="form-control" style="padding: 1.1em;" formControlName="email" id="email"
          placeholder="Enter Email">
      </div>

      <span *ngIf="!userForm.get('email').valid && userForm.get('email').touched" class="h5">
        <span *ngIf="userForm.get('email').errors['emailIsTaken']">
          This email is already in use
        </span>

        <span *ngIf="userForm.get('email').errors['required']" class="h5">
          This field is required
        </span>
      </span>
    </div>

    <div class="form-group row">
      <label class="col-lg-12" for="password">Password</label>
      <div class="col-lg-8">
        <input type="password" class="form-control" style="padding: 1.1em;" formControlName="password" id="password"
          placeholder="Enter Password">
      </div>

      <span *ngIf="!userForm.get('password').valid && userForm.get('password').touched" class="h5">

        <span *ngIf="userForm.get('password').errors['required']" class="h5">
          This field is required
        </span>
      </span>
    </div>

    <div class="form-group row">
      <label class="col-lg-12" for="phone">Phone number</label>
      <div class="col-lg-8">
        <input type="number" class="form-control" style="padding: 1.1em;" formControlName="phone" id="phone"
          placeholder="Enter Phone number">
      </div>

      <span *ngIf="!userForm.get('phone').valid && userForm.get('phone').touched" class="h5">
        <span *ngIf="userForm.get('phone').errors['phoneIsTaken']">
          This phone number is already in use
        </span>

        <span *ngIf="userForm.get('phone').errors['required']" class="h5">
          This field is required
        </span>
      </span>
    </div>

    <div class="form-group row">
      <label class="col-lg-12" for="dob">DOB</label>
      <div class="col-lg-8">
        <input type="date" class="form-control" style="padding: 1.1em;" formControlName="dob" id="dob">
      </div>

      <span *ngIf="!userForm.get('dob').valid && userForm.get('dob').touched" class="h5">

        <span *ngIf="userForm.get('dob').errors['required']" class="h5">
          This field is required
        </span>
      </span>
    </div>

    <div class="form-group row">
      <label class="col-lg-12" for="country">Country</label>
      <div class="col-lg-8">
        <select id="country" formControlName="country" class="form-control" (change)="countryChanged()">
          <option *ngFor="let country of countries" [disabled]="country === 'Select Country'" value="{{ country }}">
            {{ country }}
          </option>
        </select>
      </div>

      <span *ngIf="!userForm.get('country').valid && userForm.get('country').touched">

        <span *ngIf="userForm.get('country').errors['selectionError']" class="h5">
          Please select a country
        </span>

      </span>
    </div>

    <div class="form-group row">
      <label class="col-lg-12" for="state">State</label>
      <div class="col-lg-8">
        <select id="state" formControlName="state" class="form-control border-secondary" (change)="stateChanged()">
          <option *ngFor="let state of states" value="{{ state }}">
            {{ state }}
          </option>
        </select>
      </div>

      <span *ngIf="!userForm.get('state').valid && userForm.get('state').touched">

        <span *ngIf="userForm.get('state').touched && !userForm.get('country').valid" class="h5">
          Please select a country before selecting state
        </span>

        <span *ngIf="userForm.get('state').errors['selectionError'] && userForm.get('country').touched" class="h5">
          Please select a state
        </span>

      </span>

    </div>

    <div class="form-group row">
      <label class="col-lg-12" for="city">City</label>
      <div class="col-lg-8">
        <select id="city" formControlName="city" class="form-control">
          <option *ngFor="let city of cities" value="{{ city }}" [disabled]="city === 'Select City'">{{ city }}</option>
        </select>
      </div>

      <span *ngIf="!userForm.get('city').valid && userForm.get('city').touched">

        <span *ngIf="userForm.get('city').touched && !userForm.get('state').valid" class="h5">
          Please select a state before selecting city
        </span>

        <span *ngIf="userForm.get('city').errors['selectionError'] && userForm.get('state').touched" class="h5">
          Please select a city
        </span>

      </span>
    </div>

    <div class="form-group row">
      <label class="col-lg-12" for="pinCode">Pin Code</label>
      <div class="col-lg-8">
        <input type="number" style="padding: 1.1em;" class="form-control" formControlName="pinCode" id="pinCode"
          placeholder="Enter Pin Code">
      </div>

      <span *ngIf="!userForm.get('pinCode').valid && userForm.get('pinCode').touched">
        <span *ngIf="userForm.get('pinCode').errors['required']">
          This field is required
        </span>
      </span>

    </div>

    <div class="form-group row" *ngIf="adminMode">
      <label for="pinCode" class="col-sm-1 h5">Medicines</label>
      <div class="col-sm-5">
        <button type="button" class="btn btn-primary btn-sm" (click)="onAddMedicine()">Add Medicine</button>
        <div style="margin-top: 0.3em;" *ngFor="let control of getMedicineControls(); let i = index"
          formArrayName="medicines">
          <input type="text" class="form-control input-sm" placeholder="Medicine name" [formControlName]="i">
        </div>
      </div>
    </div>

    <div class="form-group row" *ngIf="adminMode">
      <label class="col-lg-12" for="role">Role</label>
      <div class="col-lg-8">
        <select id="role" style="padding: 1.1em;" formControlName="role" class="form-control border-secondary">
          <option *ngFor="let role of roles" value="{{role}}">{{role}}</option>
        </select>
      </div>
    </div>

    <button type="submit" class="btn btn-primary" style="margin-right: 0.3em;">Submit</button>
    <button type="button" class="btn btn-danger" (click)="onCancel()">Cancel</button>
  </form>

</div>